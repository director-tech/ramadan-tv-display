<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ramadan Workshop - Live Schedule Display</title>
    <style>
        @font-face { font-family: 'Signifier'; src: url('./Signifier-Regular.otf') format('opentype'); font-weight: 400; }
        @font-face { font-family: 'Signifier'; src: url('./Signifier-Medium.otf') format('opentype'); font-weight: 500; }
        @font-face { font-family: 'Matter'; src: url('./MatterRegular.otf') format('opentype'); font-weight: 400; }
        @font-face { font-family: 'Matter'; src: url('./MatterMedium.otf') format('opentype'); font-weight: 500; }
        @font-face { font-family: 'Matter'; src: url('./MatterSemiBold.otf') format('opentype'); font-weight: 600; }
        @font-face { font-family: 'Matter'; src: url('./MatterBold.otf') format('opentype'); font-weight: 700; }

        :root {
            --navy: #1a2744;
            --burgundy: #722F37;
            --cream: #FDFCFA;
            --charcoal: #2D2D2D;
            --slate: #4A5568;
            --light-gray: #F0F0F0;
            --green: #22A866;
            --purple: #8A68B3;
            --yellow: #eab308;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100vh;
            overflow: hidden;
            font-family: 'Matter', sans-serif;
            background: var(--cream);
            color: var(--charcoal);
        }

        .container {
            width: 100%;
            height: 100vh;
            padding: 3% 4%;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-shrink: 0;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-logos {
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .header-logos img {
            height: 50px;
            width: auto;
        }

        .header-logos-x {
            font-family: 'Signifier', serif;
            font-size: 24px;
            color: var(--slate);
        }

        .header-title {
            font-family: 'Signifier', serif;
            font-size: 2.2vw;
            font-weight: 500;
            color: var(--navy);
            margin-left: 24px;
            padding-left: 24px;
            border-left: 3px solid var(--light-gray);
            white-space: nowrap;
        }

        .header-alert {
            margin-left: 24px;
            padding: 10px 20px;
            background: var(--navy);
            color: white;
            border-radius: 8px;
            font-size: 1vw;
            font-weight: 600;
            opacity: 0;
            transform: translateX(-20px);
            transition: all 0.4s ease;
            white-space: nowrap;
        }

        .header-alert.visible {
            opacity: 1;
            transform: translateX(0);
        }

        .header-alert.warning {
            background: #dc2626;
        }

        .header-sponsor {
            font-family: 'Matter', sans-serif;
            font-size: 0.85vw;
            font-style: italic;
            color: var(--slate);
            line-height: 1.4;
            position: relative;
            display: none;
            align-items: center;
            gap: 16px;
        }

        .sponsor-qr {
            width: 120px;
            height: 120px;
            flex-shrink: 0;
        }

        .sponsor-qr-label {
            font-size: 0.6vw;
            color: var(--navy);
            font-style: normal;
            white-space: nowrap;
        }

        .header-sponsor.visible {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-left: 24px;
            padding-left: 24px;
            border-left: 2px solid var(--light-gray);
            max-width: 40vw;
        }

        .header-sponsor strong {
            font-style: normal;
            color: var(--navy);
        }

        .sponsor-text-container {
            margin: 0;
            flex: 1;
            min-width: 0;
            display: block;
        }

        .sponsor-line-1,
        .sponsor-line-2,
        .sponsor-line-3 {
            display: inline;
            background: linear-gradient(to right, #E9D5FF 50%, transparent 50%);
            background-size: 200% 100%;
            background-position: 100% 0;
            -webkit-box-decoration-break: clone;
            box-decoration-break: clone;
        }

        .header-sponsor.visible .sponsor-line-1 {
            animation: textHighlight1 100s ease-out infinite;
        }

        .header-sponsor.visible .sponsor-line-2 {
            animation: textHighlight2 100s ease-out infinite;
        }

        .header-sponsor.visible .sponsor-line-3 {
            animation: textHighlight3 100s ease-out infinite;
        }

        @keyframes textHighlight1 {
            0% { background-position: 100% 0; }
            1% { background-position: 0% 0; }
            39% { background-position: 0% 0; }
            42% { background-position: 100% 0; }
            100% { background-position: 100% 0; }
        }

        @keyframes textHighlight2 {
            0%, 1% { background-position: 100% 0; }
            2% { background-position: 0% 0; }
            36% { background-position: 0% 0; }
            39% { background-position: 100% 0; }
            100% { background-position: 100% 0; }
        }

        @keyframes textHighlight3 {
            0%, 2% { background-position: 100% 0; }
            3% { background-position: 0% 0; }
            33% { background-position: 0% 0; }
            36% { background-position: 100% 0; }
            100% { background-position: 100% 0; }
        }

        .sponsor-qr-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 24px;
            overflow: hidden;
        }

        .current-time {
            font-family: 'Matter', sans-serif;
            font-size: 2.8vw;
            font-weight: 600;
            color: var(--navy);
            white-space: nowrap;
            text-align: right;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .current-time:hover {
            color: var(--burgundy);
        }

        .current-time.manual-mode {
            color: var(--burgundy);
        }

        .event-date {
            font-size: 1vw;
            color: var(--slate);
            text-align: right;
        }

        /* Time Control Panel */
        .time-control-panel {
            position: fixed;
            top: 3%;
            right: 4%;
            width: 380px;
            height: calc(100vh - 6%);
            background: white;
            border-radius: 16px;
            box-shadow: -4px 0 30px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            padding: 30px;
            display: flex;
            flex-direction: column;
            transform: translateX(120%);
            transition: transform 0.3s ease;
        }

        .time-control-panel.visible {
            transform: translateX(0);
        }

        .time-control-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .time-control-title {
            font-family: 'Signifier', serif;
            font-size: 24px;
            font-weight: 500;
            color: var(--navy);
        }

        .time-control-close {
            background: none;
            border: none;
            font-size: 28px;
            color: var(--slate);
            cursor: pointer;
            padding: 5px;
        }

        .time-control-close:hover {
            color: var(--navy);
        }

        .time-control-mode {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .mode-btn {
            flex: 1;
            padding: 14px 20px;
            border: 2px solid var(--light-gray);
            border-radius: 10px;
            background: white;
            font-family: 'Matter', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--slate);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .mode-btn:hover {
            border-color: var(--navy);
            color: var(--navy);
        }

        .mode-btn.active {
            background: var(--navy);
            border-color: var(--navy);
            color: white;
        }

        .time-slider-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .time-slider-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--slate);
            margin-bottom: 10px;
        }

        .time-slider-value {
            font-family: 'Matter', sans-serif;
            font-size: 48px;
            font-weight: 700;
            color: var(--navy);
            text-align: center;
            margin-bottom: 20px;
        }

        .time-slider {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: var(--light-gray);
            border-radius: 4px;
            outline: none;
            margin-bottom: 15px;
        }

        .time-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: var(--navy);
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .time-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .time-slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: var(--navy);
            border-radius: 50%;
            cursor: pointer;
            border: none;
        }

        .time-slider-marks {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--slate);
            margin-bottom: 30px;
        }

        .time-sections-preview {
            border-top: 2px solid var(--light-gray);
            padding-top: 20px;
        }

        .time-sections-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--slate);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
        }

        .time-section-item {
            display: flex;
            align-items: center;
            padding: 10px 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            background: var(--light-gray);
            transition: background 0.2s ease;
        }

        .time-section-item.active {
            background: #FFEE8C;
        }

        .time-section-item.past {
            opacity: 0.4;
        }

        .time-section-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--navy);
            margin-right: 12px;
        }

        .time-section-item.active .time-section-dot {
            background: var(--yellow);
            box-shadow: 0 0 0 3px rgba(234, 179, 8, 0.3);
        }

        .time-section-name {
            font-size: 14px;
            font-weight: 500;
            color: var(--charcoal);
        }

        .time-section-range {
            margin-left: auto;
            font-size: 12px;
            color: var(--slate);
        }

        /* Column Headers - Inside Breakout Section */
        .columns-header {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        /* Unified View (Main Session & Break) */
        .unified-grid {
            display: grid;
            grid-template-columns: 3fr 1fr;
            gap: 20px;
        }

        .unified-column {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 3px 12px rgba(0, 0, 0, 0.08);
        }

        .unified-column-header {
            padding: 16px 24px;
            border-bottom: 3px solid var(--light-gray);
        }

        .unified-column.everyone .unified-column-header {
            border-top: 5px solid var(--navy);
        }

        .unified-column.kids .unified-column-header {
            border-top: 5px solid var(--green);
            background: linear-gradient(135deg, rgba(34, 168, 102, 0.08) 0%, rgba(138, 104, 179, 0.08) 100%);
        }

        .unified-column-title {
            font-family: 'Signifier', serif;
            font-size: 1.4vw;
            font-weight: 500;
        }

        .unified-column.everyone .unified-column-title { color: var(--navy); }
        .unified-column.kids .unified-column-title { color: var(--purple); }

        .unified-column-subtitle {
            font-size: 0.8vw;
            color: var(--slate);
            margin-top: 4px;
        }

        .unified-column-content {
            padding: 16px 24px;
        }

        .unified-item {
            padding: 14px 0;
            border-bottom: 1px solid var(--light-gray);
        }

        .unified-item:last-child {
            border-bottom: none;
        }

        .unified-item.active {
            background: #FFEE8C;
            margin: 0 -24px;
            padding: 14px 24px;
            border-radius: 8px;
        }

        .unified-item.active .now-badge {
            background: var(--navy);
            color: white;
        }

        .unified-item-time {
            font-size: 0.85vw;
            font-weight: 600;
            color: var(--navy);
            margin-bottom: 4px;
        }

        .unified-column.kids .unified-item-time {
            color: var(--green);
        }

        .unified-item-speaker {
            font-family: 'Signifier', serif;
            font-size: 1vw;
            font-weight: 500;
            color: var(--charcoal);
        }

        .unified-item-topic {
            font-size: 0.9vw;
            color: var(--slate);
        }

        .unified-column.kids .unified-item-topic {
            color: var(--purple);
        }

        .unified-location {
            display: flex;
            gap: 12px;
            margin-top: 8px;
        }

        .unified-item .now-badge {
            display: inline-block;
            background: var(--yellow);
            color: var(--navy);
            font-size: 0.6vw;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 4px;
            margin-left: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .column-header {
            background: white;
            border-radius: 12px;
            padding: 14px 12px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.06);
        }

        .column-header.brothers { border-top: 4px solid var(--navy); }
        .column-header.sisters { border-top: 4px solid var(--burgundy); }
        .column-header.youth-brothers { border-top: 4px solid var(--navy); }
        .column-header.youth-sisters { border-top: 4px solid var(--burgundy); }
        .column-header.kids { border-top: 4px solid var(--green); }

        .column-title {
            font-family: 'Signifier', serif;
            font-size: 1.4vw;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .column-header.brothers .column-title,
        .column-header.youth-brothers .column-title { color: var(--navy); }
        .column-header.sisters .column-title,
        .column-header.youth-sisters .column-title { color: var(--burgundy); }
        .column-header.kids .column-title { color: var(--purple); }

        .column-location {
            font-size: 0.7vw;
            font-weight: 600;
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            display: inline-block;
        }

        .column-header.brothers .column-location { background: var(--navy); }
        .column-header.sisters .column-location { background: var(--burgundy); }
        .column-header.youth-brothers .column-location { background: var(--navy); }
        .column-header.youth-sisters .column-location { background: var(--burgundy); }
        .column-header.kids .column-location { background: var(--green); }

        /* Scroll Container */
        .scroll-container {
            flex: 1;
            overflow: hidden;
            position: relative;
        }

        .scroll-content {
            transition: transform 0.3s ease-out;
        }

        /* Time Section */
        .time-section {
            margin-bottom: 24px;
        }

        .time-section-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 12px;
        }

        .time-section-badge {
            background: var(--navy);
            color: white;
            font-size: 1vw;
            font-weight: 600;
            padding: 8px 20px;
            border-radius: 8px;
        }

        .time-section-title {
            font-family: 'Signifier', serif;
            font-size: 1.4vw;
            font-weight: 500;
            color: var(--navy);
        }

        .time-section.active .time-section-badge {
            background: #FFEE8C;
            color: var(--navy);
        }

        .time-section.past {
            opacity: 0.35;
        }

        /* Schedule Grid */
        .schedule-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-auto-rows: minmax(70px, auto);
            gap: 12px;
        }

        .schedule-grid.breakout-grid {
            grid-template-rows: repeat(4, minmax(80px, auto));
        }

        .schedule-grid.closing-grid {
            grid-template-rows: auto auto auto;
        }

        /* Schedule Card */
        .schedule-card {
            background: white;
            border-radius: 10px;
            padding: 12px 14px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            min-height: 70px;
        }

        .schedule-card.span-2 { grid-row: span 2; }
        .schedule-card.span-3 { grid-row: span 3; }
        .schedule-card.span-4 { grid-row: span 4; }

        .schedule-card.empty {
            background: rgba(240, 240, 240, 0.5);
            box-shadow: none;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--slate);
            font-size: 0.75vw;
            font-style: italic;
        }

        .schedule-card.active {
            background: #FFEE8C;
        }

        .schedule-card.active .now-badge {
            background: var(--navy);
            color: white;
        }

        .card-time {
            font-size: 0.8vw;
            font-weight: 600;
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .schedule-card.brothers .card-time { color: var(--navy); }
        .schedule-card.sisters .card-time { color: var(--burgundy); }
        .schedule-card.youth-brothers .card-time { color: var(--navy); }
        .schedule-card.youth-sisters .card-time { color: var(--burgundy); }
        .schedule-card.kids .card-time { color: var(--green); }
        .schedule-card.shared .card-time { color: var(--navy); }

        .card-speaker {
            font-family: 'Signifier', serif;
            font-size: 0.95vw;
            font-weight: 500;
            color: var(--charcoal);
            margin-bottom: 2px;
        }

        .card-topic {
            font-size: 0.85vw;
            color: var(--slate);
            line-height: 1.3;
        }

        .card-location {
            margin-top: 8px;
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .location-tag {
            font-size: 0.6vw;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 10px;
            color: white;
        }

        .location-tag.brothers { background: var(--navy); }
        .location-tag.sisters { background: var(--burgundy); }

        .now-badge {
            background: var(--yellow);
            color: var(--navy);
            font-size: 0.55vw;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }


        /* Shared Card spans all columns */
        .schedule-card.shared {
            grid-column: span 5;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .schedule-card.shared-4 {
            grid-column: span 4;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        /* Alert pickup */
        .schedule-card.pickup {
            background: #fef2f2;
            border: 2px solid #fecaca;
        }

        .schedule-card.pickup .card-time,
        .schedule-card.pickup .card-topic {
            color: #dc2626;
        }

        .schedule-card.pickup .card-topic {
            font-weight: 600;
        }

    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="header-logos">
                    <img src="./magr-logo.png" alt="MAGR">
                    <span class="header-logos-x">&times;</span>
                    <img src="./sahwah-logo.png" alt="Sahwah">
                </div>
                <h1 class="header-title">Ramadan Prep Workshop</h1>
                <div class="header-sponsor" id="headerSponsor">
                    <p class="sponsor-text-container"><span class="sponsor-line-1">This hour is brought to you by the most trusted Muslim-owned pediatric practice in town.</span> <span class="sponsor-line-2"><strong>Dr. Asim Mustafa</strong> has been the childhood doctor of 3 generations of Muslims.</span> <span class="sponsor-line-3">Get your kids up to date on their flu vaccines and physicals.</span></p>
                    <div class="sponsor-qr-container">
                        <img src="./adobe-express-qr-code(2).png" alt="Book appointment" class="sponsor-qr">
                        <span class="sponsor-qr-label">Scan to book</span>
                    </div>
                </div>
                <div class="header-alert" id="headerAlert"></div>
            </div>
            <div class="header-right">
                <div class="event-date">February 7th, 2025</div>
                <div class="current-time" id="currentTime">4:00 PM</div>
            </div>
        </header>

        <!-- Scroll Container -->
        <div class="scroll-container">
            <div class="scroll-content" id="scrollContent">

                <!-- 4:00 PM - 5:00 PM Section -->
                <div class="time-section" id="section-4pm" data-start="16:00" data-end="17:00">
                    <div class="time-section-header">
                        <span class="time-section-badge">4:00 – 5:00 PM</span>
                        <span class="time-section-title">Main Session</span>
                    </div>
                    <div class="unified-grid">
                        <div class="unified-column everyone">
                            <div class="unified-column-header">
                                <div class="unified-column-title">Main Session</div>
                                <div class="unified-column-subtitle">Brothers & Youth Brothers: Main MAGR Musalla · Sisters & Youth Sisters: Women's MAGR Musalla</div>
                            </div>
                            <div class="unified-column-content">
                                <div class="unified-item" data-start="16:00" data-end="16:10">
                                    <div class="unified-item-time">4:00 – 4:10 PM</div>
                                    <div class="unified-item-topic">Quran Recitation & Introductions</div>
                                </div>
                                <div class="unified-item" data-start="16:10" data-end="16:20">
                                    <div class="unified-item-time">4:10 – 4:20 PM</div>
                                    <div class="unified-item-speaker">Sheikh Elghobashy</div>
                                    <div class="unified-item-topic">Spirituality & Preparing for Ramadan</div>
                                </div>
                                <div class="unified-item" data-start="16:20" data-end="16:35">
                                    <div class="unified-item-time">4:20 – 4:35 PM</div>
                                    <div class="unified-item-speaker">Sheikh Abdullah</div>
                                    <div class="unified-item-topic">The Importance of Quran in Ramadan</div>
                                </div>
                                <div class="unified-item" data-start="16:35" data-end="16:50">
                                    <div class="unified-item-time">4:35 – 4:50 PM</div>
                                    <div class="unified-item-speaker">Sheikh Munsif</div>
                                    <div class="unified-item-topic">Psychological Benefits of Fasting & Resilience</div>
                                </div>
                                <div class="unified-item" data-start="16:50" data-end="17:00">
                                    <div class="unified-item-time">4:50 – 5:00 PM</div>
                                    <div class="unified-item-speaker">Sheikh Abdul Rashid</div>
                                    <div class="unified-item-topic">Common Mistakes & Maximizing Your Time</div>
                                </div>
                            </div>
                        </div>
                        <div class="unified-column kids">
                            <div class="unified-column-header">
                                <div class="unified-column-title">Kids Program</div>
                                <div class="unified-column-subtitle">Ages 4-10 · Small Old Gym</div>
                            </div>
                            <div class="unified-column-content">
                                <div class="unified-item" data-start="16:00" data-end="16:30">
                                    <div class="unified-item-time">4:00 – 4:30 PM</div>
                                    <div class="unified-item-topic">Welcome & Ice Breaker</div>
                                </div>
                                <div class="unified-item" data-start="16:30" data-end="17:30">
                                    <div class="unified-item-time">4:30 – 5:30 PM</div>
                                    <div class="unified-item-topic">Storytime with the Author</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 5:00 PM - 5:45 PM Section -->
                <div class="time-section" id="section-5pm" data-start="17:00" data-end="17:45">
                    <div class="time-section-header">
                        <span class="time-section-badge">5:00 – 5:45 PM</span>
                        <span class="time-section-title">Break & Prayer</span>
                    </div>
                    <div class="unified-grid">
                        <div class="unified-column everyone">
                            <div class="unified-column-header">
                                <div class="unified-column-title">Break & Prayer</div>
                                <div class="unified-column-subtitle">Brothers & Youth Brothers: Main MAGR Musalla · Sisters & Youth Sisters: Women's MAGR Musalla</div>
                            </div>
                            <div class="unified-column-content">
                                <div class="unified-item" data-start="17:00" data-end="17:15">
                                    <div class="unified-item-time">5:00 – 5:15 PM</div>
                                    <div class="unified-item-topic">Refreshment Break — Coffee & Snacks</div>
                                </div>
                                <div class="unified-item" data-start="17:15" data-end="17:45">
                                    <div class="unified-item-time">5:15 – 5:45 PM</div>
                                    <div class="unified-item-topic">Maghrib Prayer & Sunnah</div>
                                </div>
                            </div>
                        </div>
                        <div class="unified-column kids">
                            <div class="unified-column-header">
                                <div class="unified-column-title">Kids Program</div>
                                <div class="unified-column-subtitle">Ages 4-10 · Small Old Gym</div>
                            </div>
                            <div class="unified-column-content">
                                <div class="unified-item" data-start="17:00" data-end="17:30">
                                    <div class="unified-item-time">5:00 – 5:30 PM</div>
                                    <div class="unified-item-topic">Storytime (continues)</div>
                                </div>
                                <div class="unified-item" data-start="17:30" data-end="18:00">
                                    <div class="unified-item-time">5:30 – 6:00 PM</div>
                                    <div class="unified-item-topic">Pizza Break!</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 5:45 PM - 7:30 PM Section -->
                <div class="time-section" id="section-breakout" data-start="17:45" data-end="19:30">
                    <div class="time-section-header">
                        <span class="time-section-badge">5:45 – 7:30 PM</span>
                        <span class="time-section-title">Breakout Sessions</span>
                    </div>
                    <!-- Column Headers - Part of Breakout Section -->
                    <div class="columns-header" id="columnsHeader">
                        <div class="column-header brothers">
                            <div class="column-title">Brothers</div>
                            <span class="column-location">Main Musalla</span>
                        </div>
                        <div class="column-header sisters">
                            <div class="column-title">Sisters</div>
                            <span class="column-location">Women's Musalla</span>
                        </div>
                        <div class="column-header youth-brothers">
                            <div class="column-title">Youth Brothers</div>
                            <span class="column-location">UFC Gym</span>
                        </div>
                        <div class="column-header youth-sisters">
                            <div class="column-title">Youth Sisters</div>
                            <span class="column-location">Weekend School</span>
                        </div>
                        <div class="column-header kids">
                            <div class="column-title">Kids Program</div>
                            <span class="column-location">Small Old Gym</span>
                        </div>
                    </div>
                    <div class="schedule-grid breakout-grid">
                        <!-- Brothers Column -->
                        <div class="schedule-card brothers" data-start="17:45" data-end="18:05" style="grid-column: 1; grid-row: 1;">
                            <div class="card-time">5:45 – 6:05 PM</div>
                            <div class="card-topic">Health, Diet & Fitness Panel</div>
                        </div>
                        <div class="schedule-card brothers" data-start="18:05" data-end="18:25" style="grid-column: 1; grid-row: 2;">
                            <div class="card-time">6:05 – 6:25 PM</div>
                            <div class="card-speaker">Sheikh Munsif</div>
                            <div class="card-topic">Mental Well-being & Resilience</div>
                        </div>
                        <div class="schedule-card brothers" data-start="18:25" data-end="18:45" style="grid-column: 1; grid-row: 3;">
                            <div class="card-time">6:25 – 6:45 PM</div>
                            <div class="card-speaker">Sheikh Uthman</div>
                            <div class="card-topic">Goal Setting for Ramadan</div>
                        </div>
                        <div class="schedule-card brothers" data-start="18:45" data-end="19:30" style="grid-column: 1; grid-row: 4;">
                            <div class="card-time">6:45 – 7:30 PM</div>
                            <div class="card-topic">Q&A Panel (All Speakers)</div>
                        </div>

                        <!-- Sisters Column -->
                        <div class="schedule-card sisters" data-start="17:45" data-end="18:45" style="grid-column: 2; grid-row: 1 / 4;">
                            <div class="card-time">5:45 – 6:45 PM</div>
                            <div class="card-speaker">Alima Sakina</div>
                            <div class="card-topic">Purifying the Heart</div>
                        </div>
                        <div class="schedule-card sisters" data-start="18:45" data-end="19:30" style="grid-column: 2; grid-row: 4;">
                            <div class="card-time">6:45 – 7:30 PM</div>
                            <div class="card-speaker">Alima Sakina</div>
                            <div class="card-topic">Finding Balance & Q&A</div>
                            <div class="card-topic" style="font-size: 0.65vw; color: var(--slate); margin-top: 4px;">+ Youth Sisters join</div>
                        </div>

                        <!-- Youth Brothers Column -->
                        <div class="schedule-card youth-brothers" data-start="17:45" data-end="18:15" style="grid-column: 3; grid-row: 1;">
                            <div class="card-time">5:45 – 6:15 PM</div>
                            <div class="card-speaker">Sheikh Abdul Rashid</div>
                            <div class="card-topic">School, Family & Islam</div>
                        </div>
                        <div class="schedule-card youth-brothers" data-start="18:15" data-end="18:45" style="grid-column: 3; grid-row: 2 / 4;">
                            <div class="card-time">6:15 – 6:45 PM</div>
                            <div class="card-topic">Interactive Activity</div>
                        </div>
                        <div class="schedule-card youth-brothers" data-start="18:45" data-end="19:30" style="grid-column: 3; grid-row: 4;">
                            <div class="card-time">6:45 – 7:30 PM</div>
                            <div class="card-topic">Youth Q&A Panel</div>
                        </div>

                        <!-- Youth Sisters Column -->
                        <div class="schedule-card youth-sisters" data-start="17:45" data-end="18:30" style="grid-column: 4; grid-row: 1 / 3;">
                            <div class="card-time">5:45 – 6:30 PM</div>
                            <div class="card-topic">Lasting Light: Building Practices</div>
                        </div>
                        <div class="schedule-card youth-sisters" data-start="18:30" data-end="18:45" style="grid-column: 4; grid-row: 3;">
                            <div class="card-time">6:30 – 6:45 PM</div>
                            <div class="card-topic">Intentional Goals</div>
                        </div>
                        <div class="schedule-card youth-sisters" data-start="18:45" data-end="19:30" style="grid-column: 4; grid-row: 4;">
                            <div class="card-time">6:45 – 7:30 PM</div>
                            <div class="card-speaker">Alima Sakina</div>
                            <div class="card-topic">Finding Balance & Q&A</div>
                            <div class="card-topic" style="font-size: 0.65vw; color: var(--slate); margin-top: 4px;">→ Join Sisters at Women's Musalla</div>
                        </div>

                        <!-- Kids Column -->
                        <div class="schedule-card kids" data-start="17:45" data-end="18:00" style="grid-column: 5; grid-row: 1;">
                            <div class="card-time">5:45 – 6:00 PM</div>
                            <div class="card-topic">Pizza Break (continues)</div>
                        </div>
                        <div class="schedule-card kids" data-start="18:00" data-end="19:00" style="grid-column: 5; grid-row: 2 / 4;">
                            <div class="card-time">6:00 – 7:00 PM</div>
                            <div class="card-topic">Ramadan Arts & Crafts</div>
                        </div>
                        <div class="schedule-card kids" data-start="19:00" data-end="19:30" style="grid-column: 5; grid-row: 4;">
                            <div class="card-time">7:00 – 7:30 PM</div>
                            <div class="card-topic">Movement & Playtime</div>
                        </div>
                    </div>
                </div>

                <!-- 7:30 PM - End Section -->
                <div class="time-section" id="section-closing" data-start="19:30" data-end="20:30">
                    <div class="time-section-header">
                        <span class="time-section-badge">7:30 PM – End</span>
                        <span class="time-section-title">Closing Program</span>
                    </div>
                    <div class="schedule-grid closing-grid">
                        <div class="schedule-card shared-4" data-start="19:30" data-end="19:55" style="grid-column: 1 / 5; grid-row: 1;">
                            <div>
                                <div class="card-time">7:30 – 7:55 PM</div>
                                <div class="card-speaker">Closing Remarks & Dua</div>
                            </div>
                            <div class="card-location">
                                <span class="location-tag brothers">Brothers: Main Musalla</span>
                                <span class="location-tag sisters">Sisters: Women's Musalla</span>
                            </div>
                        </div>
                        <div class="schedule-card kids" data-start="19:30" data-end="19:50" style="grid-column: 5; grid-row: 1 / 3;">
                            <div class="card-time">7:30 – 7:50 PM</div>
                            <div class="card-topic">Movement & Playtime</div>
                            <div class="card-topic" style="margin-top: 8px; color: #dc2626; font-weight: 600;">Pick up by 7:50!</div>
                        </div>

                        <div class="schedule-card shared-4" data-start="19:55" data-end="20:00" style="grid-column: 1 / 5; grid-row: 2;">
                            <div>
                                <div class="card-time">7:55 PM</div>
                                <div class="card-topic">Adhan for Isha</div>
                            </div>
                        </div>

                        <div class="schedule-card shared" data-start="20:00" data-end="20:30" style="grid-column: 1 / 6; grid-row: 3;">
                            <div>
                                <div class="card-time">8:00 PM</div>
                                <div class="card-speaker">Isha Prayer</div>
                                <div class="card-topic">Food boxes available for purchase</div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Time Control Panel -->
    <div class="time-control-panel" id="timeControlPanel">
        <div class="time-control-header">
            <h2 class="time-control-title">Time Control</h2>
            <button class="time-control-close" onclick="toggleTimeControl()">&times;</button>
        </div>

        <div class="time-control-mode">
            <button class="mode-btn active" id="liveTimeBtn" onclick="setLiveTime()">Live Time</button>
            <button class="mode-btn" id="manualTimeBtn" onclick="setManualTime()">Manual Time</button>
        </div>

        <div class="time-slider-container" style="display: none;">
            <div class="time-slider-label">Set starting time (clock will continue from here):</div>
            <div class="time-slider-value" id="sliderTimeValue">4:00 PM</div>
            <input type="range" class="time-slider" id="timeSlider" min="960" max="1230" value="960" oninput="onSliderChange(this.value)">
            <div class="time-slider-marks">
                <span>4:00 PM</span>
                <span>5:00</span>
                <span>6:00</span>
                <span>7:00</span>
                <span>8:00</span>
            </div>
            <button class="mode-btn" id="setTimeBtn" onclick="setManualStartTime()" style="margin-top: 15px; background: var(--burgundy); border-color: var(--burgundy); color: white;">Set & Start Clock</button>
            <div id="manualTimeStatus" style="margin-top: 10px; font-size: 12px; color: var(--slate); text-align: center;"></div>

            <div class="time-sections-preview">
                <div class="time-sections-title">Schedule Sections</div>
                <div class="time-section-item" data-start="960" data-end="1020">
                    <div class="time-section-dot"></div>
                    <span class="time-section-name">Main Session</span>
                    <span class="time-section-range">4:00 – 5:00 PM</span>
                </div>
                <div class="time-section-item" data-start="1020" data-end="1065">
                    <div class="time-section-dot"></div>
                    <span class="time-section-name">Break & Prayer</span>
                    <span class="time-section-range">5:00 – 5:45 PM</span>
                </div>
                <div class="time-section-item" data-start="1065" data-end="1170">
                    <div class="time-section-dot"></div>
                    <span class="time-section-name">Breakout Sessions</span>
                    <span class="time-section-range">5:45 – 7:30 PM</span>
                </div>
                <div class="time-section-item" data-start="1170" data-end="1230">
                    <div class="time-section-dot"></div>
                    <span class="time-section-name">Closing Program</span>
                    <span class="time-section-range">7:30 – 8:00+ PM</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // CONSTANTS - All magic numbers in one place
        // ============================================
        const CHICAGO_TZ = 'America/Chicago';
        const STORAGE_KEY = 'tvDisplayManualMode';

        const SCHEDULE = {
            EVENT_START: 16 * 60,       // 4:00 PM = 960 minutes
            EVENT_END: 20 * 60 + 30,    // 8:30 PM = 1230 minutes
            MAX_TIME: 23 * 60 + 59,     // 11:59 PM - max displayable time

            SECTIONS: {
                MAIN_SESSION: { start: 16 * 60, end: 17 * 60 },
                BREAK: { start: 17 * 60, end: 17 * 60 + 45 },
                BREAKOUT: { start: 17 * 60 + 45, end: 19 * 60 + 30 },
                CLOSING: { start: 19 * 60 + 30, end: 20 * 60 + 30 }
            },

            ALERTS: {
                BREAKOUT_SOON: { start: 17 * 60 + 40, end: 17 * 60 + 46, warning: false,
                    message: 'Breakout sessions starting soon — Please proceed to your designated areas' },
                RETURN_MAIN: { start: 19 * 60 + 25, end: 19 * 60 + 35, warning: false,
                    message: 'All brothers return to Main MAGR Musalla — All sisters return to Women\'s Musalla' },
                PICKUP_KIDS: { start: 19 * 60 + 45, end: 19 * 60 + 55, warning: true,
                    message: 'Parents: Please pick up your children before Isha prayer' }
            },

            SPONSOR: { start: 16 * 60, end: 17 * 60 }  // 4:00 - 5:00 PM
        };

        // ============================================
        // STATE
        // ============================================
        let isManualTime = false;
        let manualStartMinutes = SCHEDULE.EVENT_START;
        let manualStartTimestamp = null;

        // ============================================
        // CACHED DOM ELEMENTS (populated on load)
        // ============================================
        let cachedElements = null;
        let previousActiveCards = new Set();
        let previousActiveItems = new Set();
        let previousActiveSection = null;

        function getCachedElements() {
            if (!cachedElements) {
                cachedElements = {
                    sections: document.querySelectorAll('.time-section'),
                    cards: document.querySelectorAll('.schedule-card[data-start]'),
                    unifiedItems: document.querySelectorAll('.unified-item[data-start]'),
                    sectionPreviewItems: document.querySelectorAll('.time-section-item'),
                    scrollContent: document.getElementById('scrollContent'),
                    scrollContainer: document.querySelector('.scroll-container'),
                    currentTime: document.getElementById('currentTime'),
                    headerAlert: document.getElementById('headerAlert'),
                    headerSponsor: document.getElementById('headerSponsor'),
                    timeControlPanel: document.getElementById('timeControlPanel'),
                    liveTimeBtn: document.getElementById('liveTimeBtn'),
                    manualTimeBtn: document.getElementById('manualTimeBtn'),
                    sliderContainer: document.querySelector('.time-slider-container'),
                    sliderTimeValue: document.getElementById('sliderTimeValue'),
                    manualTimeStatus: document.getElementById('manualTimeStatus'),
                    setTimeBtn: document.getElementById('setTimeBtn')
                };
            }
            return cachedElements;
        }

        // ============================================
        // TIME FUNCTIONS
        // ============================================
        function getChicagoTime() {
            if (isManualTime && manualStartTimestamp) {
                const elapsed = Date.now() - manualStartTimestamp;
                const elapsedMinutes = Math.floor(elapsed / 60000);
                const elapsedSeconds = Math.floor((elapsed % 60000) / 1000);

                // Cap at max time to prevent overflow (e.g., "25:30 PM")
                let totalMinutes = Math.min(
                    manualStartMinutes + elapsedMinutes,
                    SCHEDULE.MAX_TIME
                );

                const hours = Math.floor(totalMinutes / 60);
                const minutes = totalMinutes % 60;

                return { hours, minutes, totalMinutes, seconds: elapsedSeconds };
            }

            const now = new Date();
            const chicagoTime = new Date(now.toLocaleString('en-US', { timeZone: CHICAGO_TZ }));
            const hours = chicagoTime.getHours();
            const minutes = chicagoTime.getMinutes();
            const seconds = chicagoTime.getSeconds();

            return { hours, minutes, totalMinutes: hours * 60 + minutes, seconds };
        }

        function formatTime(hours, minutes) {
            const period = hours >= 12 ? 'PM' : 'AM';
            const displayHours = hours % 12 || 12;
            const displayMinutes = minutes.toString().padStart(2, '0');
            return `${displayHours}:${displayMinutes} ${period}`;
        }

        function timeToMinutes(timeStr) {
            // Validate input to prevent NaN
            if (!timeStr || typeof timeStr !== 'string') return 0;
            const parts = timeStr.split(':');
            if (parts.length < 2) return 0;
            const hours = parseInt(parts[0], 10);
            const minutes = parseInt(parts[1], 10);
            if (isNaN(hours) || isNaN(minutes)) return 0;
            return hours * 60 + minutes;
        }

        // ============================================
        // LOCAL STORAGE PERSISTENCE
        // ============================================
        function saveManualState() {
            if (isManualTime && manualStartTimestamp) {
                localStorage.setItem(STORAGE_KEY, JSON.stringify({
                    isManualTime,
                    manualStartMinutes,
                    manualStartTimestamp
                }));
            } else {
                localStorage.removeItem(STORAGE_KEY);
            }
        }

        function restoreManualState() {
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (!saved) return false;

                const state = JSON.parse(saved);
                if (state.isManualTime && state.manualStartTimestamp) {
                    isManualTime = state.isManualTime;
                    manualStartMinutes = state.manualStartMinutes;
                    manualStartTimestamp = state.manualStartTimestamp;
                    return true;
                }
            } catch (e) {
                console.warn('Could not restore manual time state:', e);
                localStorage.removeItem(STORAGE_KEY);
            }
            return false;
        }

        // ============================================
        // TIME CONTROL PANEL FUNCTIONS
        // ============================================
        function toggleTimeControl() {
            const el = getCachedElements();
            el.timeControlPanel.classList.toggle('visible');
        }

        function setLiveTime() {
            isManualTime = false;
            manualStartTimestamp = null;
            saveManualState();

            const el = getCachedElements();
            el.liveTimeBtn.classList.add('active');
            el.manualTimeBtn.classList.remove('active');
            el.currentTime.classList.remove('manual-mode');
            el.sliderContainer.style.display = 'none';
            el.manualTimeStatus.textContent = '';
            el.setTimeBtn.textContent = 'Set & Start Clock';

            updateAll();
        }

        function setManualTime() {
            const el = getCachedElements();
            el.manualTimeBtn.classList.add('active');
            el.liveTimeBtn.classList.remove('active');
            el.currentTime.classList.add('manual-mode');
            el.sliderContainer.style.display = 'flex';
            el.manualTimeStatus.textContent = 'Select a time and click "Set & Start Clock"';
        }

        function setManualStartTime() {
            isManualTime = true;
            manualStartTimestamp = Date.now();
            saveManualState();

            const hours = Math.floor(manualStartMinutes / 60);
            const minutes = manualStartMinutes % 60;

            const el = getCachedElements();
            el.manualTimeStatus.textContent = `Clock running from ${formatTime(hours, minutes)}`;
            el.setTimeBtn.textContent = 'Update Start Time';

            updateAll();
        }

        function onSliderChange(value) {
            manualStartMinutes = parseInt(value, 10) || SCHEDULE.EVENT_START;
            const hours = Math.floor(manualStartMinutes / 60);
            const minutes = manualStartMinutes % 60;

            const el = getCachedElements();
            el.sliderTimeValue.textContent = formatTime(hours, minutes);
            updateSectionPreview(manualStartMinutes);
        }

        function updateSectionPreview(totalMins) {
            const el = getCachedElements();
            el.sectionPreviewItems.forEach(item => {
                const start = parseInt(item.dataset.start, 10) || 0;
                const end = parseInt(item.dataset.end, 10) || 0;
                item.classList.remove('active', 'past');

                if (totalMins >= start && totalMins < end) {
                    item.classList.add('active');
                } else if (totalMins >= end) {
                    item.classList.add('past');
                }
            });
        }

        // ============================================
        // UI UPDATE FUNCTIONS (split for clarity)
        // ============================================
        function updateClock() {
            const { hours, minutes } = getChicagoTime();
            const el = getCachedElements();
            el.currentTime.textContent = formatTime(hours, minutes);
        }

        function updateSections(totalMinutes) {
            const el = getCachedElements();
            let newActiveSection = null;

            el.sections.forEach(section => {
                const start = timeToMinutes(section.dataset.start);
                const end = timeToMinutes(section.dataset.end);
                const isActive = totalMinutes >= start && totalMinutes < end;
                const isPast = totalMinutes >= end;

                section.classList.toggle('active', isActive);
                section.classList.toggle('past', isPast);

                if (isActive) newActiveSection = section;
            });

            previousActiveSection = newActiveSection;
        }

        function updateBadge(element, isActive, timeSelector) {
            const existingBadge = element.querySelector('.now-badge');

            if (isActive && !existingBadge) {
                const timeEl = element.querySelector(timeSelector);
                if (timeEl) {
                    const badge = document.createElement('span');
                    badge.className = 'now-badge';
                    badge.textContent = 'NOW';
                    timeEl.appendChild(badge);
                }
            } else if (!isActive && existingBadge) {
                existingBadge.remove();
            }
        }

        function updateCards(totalMinutes) {
            const el = getCachedElements();
            const newActiveCards = new Set();

            el.cards.forEach(card => {
                const start = timeToMinutes(card.dataset.start);
                const end = timeToMinutes(card.dataset.end);
                const isActive = totalMinutes >= start && totalMinutes < end;
                const wasActive = previousActiveCards.has(card);

                if (isActive) newActiveCards.add(card);

                // Only update DOM if state changed
                if (isActive !== wasActive) {
                    card.classList.toggle('active', isActive);
                    updateBadge(card, isActive, '.card-time');
                }
            });

            previousActiveCards = newActiveCards;
        }

        function updateUnifiedItems(totalMinutes) {
            const el = getCachedElements();
            const newActiveItems = new Set();

            el.unifiedItems.forEach(item => {
                const start = timeToMinutes(item.dataset.start);
                const end = timeToMinutes(item.dataset.end);
                const isActive = totalMinutes >= start && totalMinutes < end;
                const wasActive = previousActiveItems.has(item);

                if (isActive) newActiveItems.add(item);

                // Only update DOM if state changed
                if (isActive !== wasActive) {
                    item.classList.toggle('active', isActive);
                    updateBadge(item, isActive, '.unified-item-time');
                }
            });

            previousActiveItems = newActiveItems;
        }

        function updateSponsor(totalMinutes) {
            const el = getCachedElements();
            const isVisible = totalMinutes >= SCHEDULE.SPONSOR.start &&
                              totalMinutes < SCHEDULE.SPONSOR.end;
            el.headerSponsor.classList.toggle('visible', isVisible);
        }

        function autoScroll() {
            const el = getCachedElements();
            const activeSection = document.querySelector('.time-section.active');

            if (activeSection && el.scrollContainer) {
                const containerHeight = el.scrollContainer.offsetHeight;
                const sectionTop = activeSection.offsetTop;
                const sectionHeight = activeSection.offsetHeight;

                let scrollTo;
                if (sectionHeight < containerHeight) {
                    // Section is smaller than container - center it
                    const centerOffset = (containerHeight - sectionHeight) / 2;
                    scrollTo = sectionTop - centerOffset;
                } else {
                    // Section is larger - align to top
                    scrollTo = sectionTop;
                }

                el.scrollContent.style.transform = `translateY(-${Math.max(0, scrollTo)}px)`;
            } else {
                el.scrollContent.style.transform = 'translateY(0)';
            }
        }

        function updateAlerts(totalMinutes) {
            const el = getCachedElements();
            let activeAlert = null;

            // Check all alerts using the constants
            for (const [key, alert] of Object.entries(SCHEDULE.ALERTS)) {
                if (totalMinutes >= alert.start && totalMinutes < alert.end) {
                    activeAlert = alert;
                    break;
                }
            }

            if (activeAlert) {
                el.headerAlert.textContent = activeAlert.message;
                el.headerAlert.classList.add('visible');
                el.headerAlert.classList.toggle('warning', activeAlert.warning);
            } else {
                el.headerAlert.classList.remove('visible');
            }
        }

        // ============================================
        // MAIN UPDATE FUNCTION
        // ============================================
        function updateHighlights() {
            const { totalMinutes } = getChicagoTime();

            updateSections(totalMinutes);
            updateCards(totalMinutes);
            updateUnifiedItems(totalMinutes);
            autoScroll();
            updateAlerts(totalMinutes);
            updateSponsor(totalMinutes);
        }

        function updateAll() {
            updateClock();
            updateHighlights();
        }

        // ============================================
        // INITIALIZATION
        // ============================================
        function initializeApp() {
            // Cache DOM elements first
            getCachedElements();

            // Set up click handler for time control
            const el = getCachedElements();
            el.currentTime.addEventListener('click', toggleTimeControl);

            // Restore manual mode if saved
            if (restoreManualState()) {
                el.manualTimeBtn.classList.add('active');
                el.liveTimeBtn.classList.remove('active');
                el.currentTime.classList.add('manual-mode');
                el.sliderContainer.style.display = 'flex';

                const hours = Math.floor(manualStartMinutes / 60);
                const minutes = manualStartMinutes % 60;
                el.sliderTimeValue.textContent = formatTime(hours, minutes);
                el.manualTimeStatus.textContent = `Clock running from ${formatTime(hours, minutes)}`;
                el.setTimeBtn.textContent = 'Update Start Time';

                // Update slider position
                document.getElementById('timeSlider').value = manualStartMinutes;
            }

            // Initial update
            updateAll();

            // Start update loop
            setInterval(updateAll, 1000);
        }

        // Wait for DOM to be ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }
    </script>
</body>
</html>
